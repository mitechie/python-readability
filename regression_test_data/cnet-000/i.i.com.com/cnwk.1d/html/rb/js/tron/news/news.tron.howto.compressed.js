
   if(!dbugScripts("news",["news.tron.howto.js"])) {
   /*	news.tron.howto.js - packed	*/
       var Slider=new Class({Implements:[Events,Options],options:{onTick:function(A){if(this.options.snap){A=this.toPosition(this.step);}this.knob.setStyle(this.property,A);},snap:false,offset:0,range:false,wheel:false,steps:100,mode:"horizontal"},initialize:function(E,A,D){this.setOptions(D);this.element=$(E);this.knob=$(A);this.previousChange=this.previousEnd=this.step=-1;this.element.addEvent("mousedown",this.clickedElement.bind(this));if(this.options.wheel){this.element.addEvent("mousewheel",this.scrolledElement.bindWithEvent(this));}var F,B={},C={x:false,y:false};switch(this.options.mode){case"vertical":this.axis="y";this.property="top";F="offsetHeight";break;case"horizontal":this.axis="x";this.property="left";F="offsetWidth";}this.half=this.knob[F]/2;this.full=this.element[F]-this.knob[F]+(this.options.offset*2);this.min=$chk(this.options.range[0])?this.options.range[0]:0;this.max=$chk(this.options.range[1])?this.options.range[1]:this.options.steps;this.range=this.max-this.min;this.steps=this.options.steps||this.full;this.stepSize=Math.abs(this.range)/this.steps;this.stepWidth=this.stepSize*this.full/Math.abs(this.range);this.knob.setStyle("position","relative").setStyle(this.property,-this.options.offset);C[this.axis]=this.property;B[this.axis]=[-this.options.offset,this.full-this.options.offset];this.drag=new Drag(this.knob,{snap:0,limit:B,modifiers:C,onDrag:this.draggedKnob.bind(this),onStart:this.draggedKnob.bind(this),onComplete:function(){this.draggedKnob();this.end();}.bind(this)});if(this.options.snap){this.drag.options.grid=Math.ceil(this.stepWidth);this.drag.options.limit[this.axis][1]=this.full;}},set:function(A){if(!((this.range>0)^(A<this.min))){A=this.min;}if(!((this.range>0)^(A>this.max))){A=this.max;}this.step=Math.round(A);this.checkStep();this.end();this.fireEvent("tick",this.toPosition(this.step));return this;},clickedElement:function(C){var B=this.range<0?-1:1;var A=C.page[this.axis]-this.element.getPosition()[this.axis]-this.half;A=A.limit(-this.options.offset,this.full-this.options.offset);this.step=Math.round(this.min+B*this.toStep(A));this.checkStep();this.end();this.fireEvent("tick",A);},scrolledElement:function(A){var B=(this.options.mode=="horizontal")?(A.wheel<0):(A.wheel>0);this.set(B?this.step-this.stepSize:this.step+this.stepSize);A.stop();},draggedKnob:function(){var B=this.range<0?-1:1;var A=this.drag.value.now[this.axis];A=A.limit(-this.options.offset,this.full-this.options.offset);this.step=Math.round(this.min+B*this.toStep(A));this.checkStep();},checkStep:function(){if(this.previousChange!=this.step){this.previousChange=this.step;this.fireEvent("change",this.step);}},end:function(){if(this.previousEnd!==this.step){this.previousEnd=this.step;this.fireEvent("complete",this.step+"");}},toStep:function(A){var B=(A+this.options.offset)*this.stepSize/this.full*this.steps;return this.options.steps?Math.round(B-=B%this.stepSize):B;},toPosition:function(A){return(this.full*Math.abs(this.min-A))/(this.steps*this.stepSize)-this.options.offset;}});var ForumsFormValidator=new Class({Extends:FormValidator,test:function(C,E,F){E=$(E);if(E.hasClass("ignoreValidation")){return true;}F=$pick(F,false);if(E.hasClass("warnOnly")){F=true;}var D=true;if(E){var B=this.getValidator(C);if(B&&(this.isVisible(E)||E.hasClass("validateWhileHidden"))){D=B.test(E);if(!D&&B.getError(E)){if(F){E.addClass("warning");}var A=this.makeAdvice(C,E,B.getError(E),F);this.insertAdvice(A,E);this.showAdvice(C,E);}else{this.hideAdvice(C,E);}this.fireEvent("onElementValidate",[D,E,C]);}}if(F){return true;}return D;},insertAdvice:function(A,B){A.inject($(B),"before");}});$extend(ForumsFormValidator,FormValidator.adders);ForumsFormValidator.implement(FormValidator.adders);ForumsFormValidator.add("validate-minFields",{errorMsg:function(A,B){if($type(B.minFields)){return"Please enter at least "+B.minFields+" values.";}else{return"";}},test:function(B,C){var D=B.getParent("form").getElements("input[name="+B.get("name")+"]");var A=0;var E=0;while(A<D.length&&E<C.minFields){if(D[A].get("value").length>0){E++;}A++;}return E>=C.minFields;}});ForumsFormValidator.add("validate-radio",{errorMsg:function(A,B){return A.title||"Please select a value.";},test:function(B,C){var E=B.getParent("form").getElements("input[name="+B.get("name")+"]");var A=0;var D=false;while(!D&&A<E.length){D=E[A].get("checked");A++;}return D;}});(function(){var C=/^(H[1-6]|HR|P|DIV|ADDRESS|PRE|FORM|TABLE|LI|OL|UL|TD|CAPTION|BLOCKQUOTE|CENTER|DL|DT|DD|SCRIPT|NOSCRIPT|STYLE)$/i;var D=/^(https?|ftp|rmtp|mms):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)(:(\d+))?\/?/i;var B=/<(script|noscript|style)[\u0000-\uFFFF]*?<\/(script|noscript|style)>/g;this.MooEditable=new Class({Implements:[Events,Options],options:{toolbar:true,cleanup:true,paragraphise:true,xhtml:true,semantics:true,actions:"bold italic underline strikethrough | insertunorderedlist insertorderedlist indent outdent | undo redo | createlink unlink | urlimage | toggleview",handleSubmit:true,handleLabel:true,disabled:false,baseCSS:"html{ height: 100%; cursor: text; } body{ font-family: sans-serif; }",extraCSS:"",externalCSS:"",html:'<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">{BASEHREF}<style>{BASECSS} {EXTRACSS}</style>{EXTERNALCSS}</head><body></body></html>',rootElement:"p",baseURL:"",dimensions:null},initialize:function(F,E){var G=new MobileChecker();this.isMobile=G.isMobile();if(this.isMobile){return ;}this.setOptions(E);this.textarea=$(F);this.textarea.store("MooEditable",this);this.actions=this.options.actions.clean().split(" ");this.keys={};this.dialogs={};this.protectedElements=[];this.actions.each(function(J){var H=MooEditable.Actions[J];if(!H){return ;}if(H.options){var I=H.options.shortcut;if(I){this.keys[I]=J;}}if(H.dialogs){$each(H.dialogs,function(L,K){L=L.attempt(this);L.name=J+":"+K;if($type(this.dialogs[J])!="object"){this.dialogs[J]={};}this.dialogs[J][K]=L;},this);}if(H.events){$each(H.events,function(K,L){this.addEvent(L,K);},this);}}.bind(this));this.render();},toElement:function(){return this.textarea;},render:function(){if(this.isMobile){return ;}var E=this;var F=this.options.dimensions||this.textarea.getSize();this.container=new Element("div",{id:(this.textarea.id)?this.textarea.id+"-mooeditable-container":null,"class":"mooeditable-container",styles:{width:F.x}});this.textarea.addClass("mooeditable-textarea").setStyle("height",F.y);this.iframe=new IFrame({"class":"mooeditable-iframe",frameBorder:0,src:'javascript:""',styles:{height:F.y}});this.toolbar=new MooEditable.UI.Toolbar({onItemAction:function(){var G=$splat(arguments);var H=G[0];E.action(H.name,G);}});this.attach.delay(1,this);if(this.options.handleLabel&&this.textarea.id){$$('label[for="'+this.textarea.id+'"]').addEvent("click",function(G){if(E.mode!="iframe"){return ;}G.preventDefault();E.focus();});}if(this.options.handleSubmit){this.form=this.textarea.getParent("form");if(!this.form){return ;}this.form.addEvent("submit",function(){if(E.mode=="iframe"){E.saveContent();}});}this.fireEvent("render",this);},attach:function(){if(this.isMobile){return ;}var E=this;this.mode="iframe";this.editorDisabled=false;this.container.wraps(this.textarea);this.textarea.setStyle("display","none");this.iframe.setStyle("display","").inject(this.textarea,"before");$each(this.dialogs,function(I,H){$each(I,function(K){$(K).inject(E.iframe,"before");var J;K.addEvents({open:function(){J=E.selection.getRange();E.editorDisabled=true;E.toolbar.disable(H);E.fireEvent("dialogOpen",this);},close:function(){E.toolbar.enable();E.editorDisabled=false;E.focus();if(J){E.selection.setRange(J);}E.fireEvent("dialogClose",this);}});});});this.win=this.iframe.contentWindow;this.doc=this.win.document;if(Browser.firefox){this.doc.designMode="On";}var G=this.options.html.substitute({BASECSS:this.options.baseCSS,EXTRACSS:this.options.extraCSS,EXTERNALCSS:(this.options.externalCSS)?'<link rel="stylesheet" href="'+this.options.externalCSS+'">':"",BASEHREF:(this.options.baseURL)?'<base href="'+this.options.baseURL+'" />':""});this.doc.open();this.doc.write(G);this.doc.close();(Browser.Engine.trident)?this.doc.body.contentEditable=true:this.doc.designMode="On";if(!this.win.$family){new Window(this.win);}if(!this.doc.$family){new Document(this.doc);}$(this.doc.body);this.setContent(this.textarea.get("value"));this.doc.addEvents({mouseup:this.editorMouseUp.bind(this),mousedown:this.editorMouseDown.bind(this),mouseover:this.editorMouseOver.bind(this),mouseout:this.editorMouseOut.bind(this),mouseenter:this.editorMouseEnter.bind(this),mouseleave:this.editorMouseLeave.bind(this),contextmenu:this.editorContextMenu.bind(this),click:this.editorClick.bind(this),dblclick:this.editorDoubleClick.bind(this),keypress:this.editorKeyPress.bind(this),keyup:this.editorKeyUp.bind(this),keydown:this.editorKeyDown.bind(this),focus:this.editorFocus.bind(this),blur:this.editorBlur.bind(this)});this.win.addEvents({focus:this.editorFocus.bind(this),blur:this.editorBlur.bind(this)});["cut","copy","paste"].each(function(H){E.doc.body.addListener(H,E["editor"+H.capitalize()].bind(E));});this.textarea.addEvent("keypress",this.textarea.retrieve("mooeditable:textareaKeyListener",this.keyListener.bind(this)));if(Browser.Engine.gecko&&Browser.Engine.version==18){this.doc.addEvent("focus",function(){E.win.fireEvent("focus").focus();});}if(!(/trident|presto/i).test(Browser.Engine.name)){var F=function(){E.execute("styleWithCSS",false,false);E.doc.removeEvent("focus",F);};this.win.addEvent("focus",F);}if(this.options.toolbar){$(this.toolbar).inject(this.container,"top");this.toolbar.render(this.actions);}if(this.options.disabled){this.disable();}this.selection=new MooEditable.Selection(this.win);this.oldContent=this.getContent();this.fireEvent("attach",this);return this;},detach:function(){if(this.isMobile){return ;}this.saveContent();this.textarea.setStyle("display","").removeClass("mooeditable-textarea").inject(this.container,"before");this.textarea.removeEvent("keypress",this.textarea.retrieve("mooeditable:textareaKeyListener"));this.container.dispose();this.fireEvent("detach",this);return this;},enable:function(){if(this.isMobile){return ;}this.editorDisabled=false;this.toolbar.enable();return this;},disable:function(){if(this.isMobile){return ;}this.editorDisabled=true;this.toolbar.disable();return this;},editorFocus:function(E){this.oldContent="";this.fireEvent("editorFocus",[E,this]);},editorBlur:function(E){this.oldContent=this.saveContent().getContent();this.fireEvent("editorBlur",[E,this]);},editorMouseUp:function(E){if(this.editorDisabled){E.stop();return ;}if(this.options.toolbar){this.checkStates();}this.fireEvent("editorMouseUp",[E,this]);},editorMouseDown:function(E){if(this.editorDisabled){E.stop();return ;}this.fireEvent("editorMouseDown",[E,this]);},editorMouseOver:function(E){if(this.editorDisabled){E.stop();return ;}this.fireEvent("editorMouseOver",[E,this]);},editorMouseOut:function(E){if(this.editorDisabled){E.stop();return ;}this.fireEvent("editorMouseOut",[E,this]);},editorMouseEnter:function(E){if(this.editorDisabled){E.stop();return ;}if(this.oldContent&&this.getContent()!=this.oldContent){this.focus();this.fireEvent("editorPaste",[E,this]);}this.fireEvent("editorMouseEnter",[E,this]);},editorMouseLeave:function(E){if(this.editorDisabled){E.stop();return ;}this.fireEvent("editorMouseLeave",[E,this]);},editorContextMenu:function(E){if(this.editorDisabled){E.stop();return ;}this.fireEvent("editorContextMenu",[E,this]);},editorClick:function(F){if(Browser.Engine.webkit){var E=F.target;if(E.get("tag")=="img"){if(this.options.baseURL){if(E.getProperty("src").indexOf("http://")==-1){E.setProperty("src",this.options.baseURL+E.getProperty("src"));}}this.selection.selectNode(E);this.checkStates();}}this.fireEvent("editorClick",[F,this]);},editorDoubleClick:function(E){this.fireEvent("editorDoubleClick",[E,this]);},editorKeyPress:function(E){if(this.editorDisabled){E.stop();return ;}this.keyListener(E);this.fireEvent("editorKeyPress",[E,this]);},editorKeyUp:function(E){if(this.editorDisabled){E.stop();return ;}var F=E.code;if(this.options.toolbar&&(/^enter|left|up|right|down|delete|backspace$/i.test(E.key)||(F>=33&&F<=36)||F==45||E.meta||E.control)){if(Browser.Engine.trident4){$clear(this.checkStatesDelay);this.checkStatesDelay=this.checkStates.delay(500,this);}else{this.checkStates();}}this.fireEvent("editorKeyUp",[E,this]);},editorKeyDown:function(J){if(this.editorDisabled){J.stop();return ;}if(J.key=="enter"){if(this.options.paragraphise){if(J.shift&&Browser.Engine.webkit){var N=this.selection;var E=N.getRange();var M=this.doc.createElement("br");E.insertNode(M);E.setStartAfter(M);E.setEndAfter(M);N.setRange(E);if(N.getSelection().focusNode==M.previousSibling){var L=this.doc.createTextNode("\u00a0");var F=M.parentNode;var K=M.nextSibling;(K)?F.insertBefore(L,K):F.appendChild(L);N.selectNode(L);N.collapse(1);}this.win.scrollTo(0,Element.getOffsets(N.getRange().startContainer).y);J.preventDefault();}else{if(Browser.Engine.gecko||Browser.Engine.webkit){var H=this.selection.getNode();var G=H.getParents().include(H).some(function(O){return O.nodeName.test(C);});if(!G){this.execute("insertparagraph");}}}}else{if(Browser.Engine.trident){var E=this.selection.getRange();var H=this.selection.getNode();if(E&&H.get("tag")!="li"){this.selection.insertContent("<br>");this.selection.collapse(false);}J.preventDefault();}}}else{if(J.key=="tab"&&Browser.Engine.webkit){J.stop();}}if(Browser.Engine.presto){var I=J.control||J.meta;if(I&&J.key=="x"){this.fireEvent("editorCut",[J,this]);}else{if(I&&J.key=="c"){this.fireEvent("editorCopy",[J,this]);}else{if((I&&J.key=="v")||(J.shift&&J.code==45)){this.fireEvent("editorPaste",[J,this]);}}}}this.fireEvent("editorKeyDown",[J,this]);},editorCut:function(E){if(this.editorDisabled){E.stop();return ;}this.fireEvent("editorCut",[E,this]);},editorCopy:function(E){if(this.editorDisabled){E.stop();return ;}this.fireEvent("editorCopy",[E,this]);},editorPaste:function(E){if(this.editorDisabled){E.stop();return ;}this.fireEvent("editorPaste",[E,this]);},keyListener:function(G){var E=(Browser.Platform.mac)?G.meta:G.control;if(!E||!this.keys[G.key]){return ;}G.preventDefault();var F=this.toolbar.getItem(this.keys[G.key]);F.action(G);},focus:function(){(this.mode=="iframe"?this.win:this.textarea).focus();this.fireEvent("focus",this);return this;},action:function(G,E){var F=MooEditable.Actions[G];if(F.command&&$type(F.command)=="function"){F.command.run(E,this);}else{this.focus();this.execute(G,false,E);if(this.mode=="iframe"){this.checkStates();}}},execute:function(G,F,E){if(this.busy){return ;}this.busy=true;this.doc.execCommand(G,F,E);this.saveContent();this.busy=false;return false;},toggleView:function(){this.fireEvent("beforeToggleView",this);if(this.mode=="textarea"){this.mode="iframe";this.iframe.setStyle("display","");this.setContent(this.textarea.value);this.textarea.setStyle("display","none");}else{this.saveContent();this.mode="textarea";this.textarea.setStyle("display","");this.iframe.setStyle("display","none");}this.fireEvent("toggleView",this);this.focus.delay(10,this);return this;},getContent:function(){var E=this.protectedElements;var F=this.doc.body.get("html").replace(/<!-- mooeditable:protect:([0-9]+) -->/g,function(H,G){return E[G.toInt()];});return this.cleanup(this.ensureRootElement(F));},setContent:function(F){var E=this.protectedElements;F=F.replace(B,function(G){E.push(G);return"<!-- mooeditable:protect:"+(E.length-1)+" -->";});this.doc.body.set("html",this.ensureRootElement(F));return this;},saveContent:function(){if(this.mode=="iframe"){this.textarea.set("value",this.getContent());}return this;},ensureRootElement:function(J){if(this.options.rootElement){var I=new Element("div",{html:J.trim()});var G=-1;var M=false;var N="";var H=I.childNodes.length;for(var L=0;L<H;L++){var E=I.childNodes[L];var O=E.nodeName;if(!O.test(C)&&O!=="#comment"){if(O==="#text"){if(E.nodeValue.trim()){if(G<0){G=L;}N+=E.nodeValue;}}else{if(G<0){G=L;}N+=new Element("div").adopt($(E).clone()).get("html");}}else{M=true;}if(L==(H-1)){M=true;}if(G>=0&&M){var F=new Element(this.options.rootElement,{html:N});I.replaceChild(F,I.childNodes[G]);for(var K=G+1;K<L;K++){I.removeChild(I.childNodes[K]);H--;L--;K--;}G=-1;M=false;N="";}}J=I.get("html").replace(/\n\n/g,"");}return J;},checkStates:function(){var E=this.selection.getNode();if(!E){return ;}if($type(E)!="element"){return ;}this.actions.each(function(H){var K=this.toolbar.getItem(H);if(!K){return ;}K.deactivate();var L=MooEditable.Actions[H]["states"];if(!L){return ;}if($type(L)=="function"){L.attempt([$(E),K],this);return ;}try{if(this.doc.queryCommandState(H)){K.activate();return ;}}catch(J){}if(L.tags){var G=E;do{var N=G.tagName.toLowerCase();if(L.tags.contains(N)){K.activate(N);break;}}while((G=Element.getParent(G))!=null);}if(L.css){var G=E;do{var M=false;for(var F in L.css){var I=L.css[F];if(Element.getStyle(G,F).contains(I)){K.activate(I);M=true;}}if(M||G.tagName.test(C)){break;}}while((G=Element.getParent(G))!=null);}}.bind(this));},cleanup:function(F){if(!this.options.cleanup){return F.trim();}do{var E=F;if(this.options.baseURL){F=F.replace('="'+this.options.baseURL,'="');}F=F.replace(/<br class\="webkit-block-placeholder">/gi,"<br />");F=F.replace(/<span class="Apple-style-span">(.*)<\/span>/gi,"$1");F=F.replace(/ class="Apple-style-span"/gi,"");F=F.replace(/<span style="">/gi,"");F=F.replace(/<p>\s*<br ?\/?>\s*<\/p>/gi,"<p>\u00a0</p>");F=F.replace(/<p>(&nbsp;|\s)*<\/p>/gi,"<p>\u00a0</p>");if(!this.options.semantics){F=F.replace(/\s*<br ?\/?>\s*<\/p>/gi,"</p>");}if(this.options.xhtml){F=F.replace(/<br>/gi,"<br />");}if(this.options.semantics){if(Browser.Engine.trident){F=F.replace(/<li>\s*<div>(.+?)<\/div><\/li>/g,"<li>$1</li>");}if(Browser.Engine.webkit){F=F.replace(/^([\w\s]+.*?)<div>/i,"<p>$1</p><div>");F=F.replace(/<div>(.+?)<\/div>/ig,"<p>$1</p>");}if(["gecko","presto","webkit"].contains(Browser.Engine.name)){F=F.replace(/<p>[\s\n]*(<(?:ul|ol)>.*?<\/(?:ul|ol)>)(.*?)<\/p>/ig,"$1<p>$2</p>");F=F.replace(/<\/(ol|ul)>\s*(?!<(?:p|ol|ul|img).*?>)((?:<[^>]*>)?\w.*)$/g,"</$1><p>$2</p>");}F=F.replace(/<br[^>]*><\/p>/g,"</p>");F=F.replace(/<p>\s*(<img[^>]+>)\s*<\/p>/ig,"$1\n");F=F.replace(/<p([^>]*)>(.*?)<\/p>(?!\n)/g,"<p$1>$2</p>\n");F=F.replace(/<\/(ul|ol|p)>(?!\n)/g,"</$1>\n");F=F.replace(/><li>/g,">\n\t<li>");F=F.replace(/([^\n])<\/(ol|ul)>/g,"$1\n</$2>");F=F.replace(/([^\n])<img/ig,"$1\n<img");F=F.replace(/^\s*$/g,"");}F=F.replace(/<br ?\/?>$/gi,"");F=F.replace(/^<br ?\/?>/gi,"");if(this.options.paragraphise){F=F.replace(/(h[1-6]|p|div|address|pre|li|ol|ul|blockquote|center|dl|dt|dd)><br ?\/?>/gi,"$1>");}F=F.replace(/<br ?\/?>\s*<\/(h1|h2|h3|h4|h5|h6|li|p)/gi,"</$1");F=F.replace(/<span style="font-weight: bold;">(.*)<\/span>/gi,"<strong>$1</strong>");F=F.replace(/<span style="font-style: italic;">(.*)<\/span>/gi,"<em>$1</em>");F=F.replace(/<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>");F=F.replace(/<i\b[^>]*>(.*?)<\/i[^>]*>/gi,"<em>$1</em>");F=F.replace(/<u\b[^>]*>(.*?)<\/u[^>]*>/gi,'<span style="text-decoration: underline;">$1</span>');F=F.replace(/<strong><span style="font-weight: normal;">(.*)<\/span><\/strong>/gi,"$1");F=F.replace(/<em><span style="font-weight: normal;">(.*)<\/span><\/em>/gi,"$1");F=F.replace(/<span style="text-decoration: underline;"><span style="font-weight: normal;">(.*)<\/span><\/span>/gi,"$1");F=F.replace(/<strong style="font-weight: normal;">(.*)<\/strong>/gi,"$1");F=F.replace(/<em style="font-weight: normal;">(.*)<\/em>/gi,"$1");F=F.replace(/<[^> ]*/g,function(G){return G.toLowerCase();});F=F.replace(/<[^>]*>/g,function(G){G=G.replace(/ [^=]+=/g,function(H){return H.toLowerCase();});return G;});F=F.replace(/<[^!][^>]*>/g,function(G){G=G.replace(/( [^=]+=)([^"][^ >]*)/g,'$1"$2"');return G;});if(this.options.xhtml){F=F.replace(/<img([^>]+)(\s*[^\/])>(<\/img>)*/gi,"<img$1$2 />");}F=F.replace(/<p>(?:\s*)<p>/g,"<p>");F=F.replace(/<\/p>\s*<\/p>/g,"</p>");F=F.replace(/<pre[^>]*>.*?<\/pre>/gi,function(G){return G.replace(/<br ?\/?>/gi,"\n");});F=F.trim();}while(F!=E);return F;}});MooEditable.Selection=new Class({initialize:function(E){this.win=E;},getSelection:function(){this.win.focus();return(this.win.getSelection)?this.win.getSelection():this.win.document.selection;},getRange:function(){var E=this.getSelection();if(!E){return null;}try{return E.rangeCount>0?E.getRangeAt(0):(E.createRange?E.createRange():null);}catch(F){return this.doc.body.createTextRange();}},setRange:function(E){if(E.select){$try(function(){E.select();});}else{var F=this.getSelection();if(F.addRange){F.removeAllRanges();F.addRange(E);}}},selectNode:function(G,H){var F=this.getRange();var E=this.getSelection();if(F.moveToElementText){$try(function(){F.moveToElementText(G);F.select();});}else{if(E.addRange){H?F.selectNodeContents(G):F.selectNode(G);E.removeAllRanges();E.addRange(F);}else{E.setBaseAndExtent(G,0,G,1);}}return G;},isCollapsed:function(){var E=this.getRange();if(E.item){return false;}return E.boundingWidth==0||this.getSelection().isCollapsed;},collapse:function(E){var G=this.getRange();var F=this.getSelection();if(G.select){G.collapse(E);G.select();}else{E?F.collapseToStart():F.collapseToEnd();}},getContent:function(){var G=this.getRange();var E=new Element("body");if(this.isCollapsed()){return"";}if(G.cloneContents){E.appendChild(G.cloneContents());}else{if($defined(G.item)||$defined(G.htmlText)){E.set("html",G.item?G.item(0).outerHTML:G.htmlText);}else{E.set("html",G.toString());}}var F=E.get("html");return F;},getText:function(){var F=this.getRange();var E=this.getSelection();return this.isCollapsed()?"":F.text||(E.toString?E.toString():"");},getNode:function(){var F=this.getRange();if(!Browser.Engine.trident){var E=null;if(F){E=F.commonAncestorContainer;if(!F.collapsed){if(F.startContainer==F.endContainer){if(F.startOffset-F.endOffset<2){if(F.startContainer.hasChildNodes()){E=F.startContainer.childNodes[F.startOffset];}}}}while($type(E)!="element"){E=E.parentNode;}}return $(E);}return $(F.item?F.item(0):F.parentElement());},insertContent:function(F){if(Browser.Engine.trident){var E=this.getRange();E.pasteHTML(F);E.collapse(false);E.select();}else{this.win.document.execCommand("insertHTML",false,F);}}});var A={};MooEditable.lang={set:function(E){if(MooTools.lang){MooTools.lang.set("en-US","MooEditable",E);}$extend(A,E);},get:function(E){if(MooTools.lang){return MooTools.lang.get("MooEditable",E);}return E?A[E]:"";}};MooEditable.lang.set({ok:"OK",cancel:"Cancel",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",unorderedList:"Unordered List",orderedList:"Ordered List",indent:"Indent",outdent:"Outdent",undo:"Undo",redo:"Redo",removeHyperlink:"Remove Hyperlink",addHyperlink:"Add Hyperlink",selectTextHyperlink:"Please select the text you wish to hyperlink.",enterURL:"Enter URL",enterImageURL:"Enter image URL",addImage:"Add Image",toggleView:"Toggle View"});MooEditable.UI={};MooEditable.UI.Toolbar=new Class({Implements:[Events,Options],options:{"class":""},initialize:function(E){this.setOptions(E);this.el=new Element("div",{"class":"mooeditable-ui-toolbar "+this.options["class"]});this.items={};this.content=null;},toElement:function(){return this.el;},render:function(E){if(this.content){this.el.adopt(this.content);}else{this.content=E.map(function(F){return(F=="|")?this.addSeparator():this.addItem(F);}.bind(this));}return this;},addItem:function(J){var F=this;var E=MooEditable.Actions[J];if(!E){return ;}var H=E.type||"button";var G=E.options||{};var I=new MooEditable.UI[H.camelCase().capitalize()]($extend(G,{name:J,"class":J+"-item toolbar-item",title:E.title,onAction:F.itemAction.bind(F)}));this.items[J]=I;$(I).inject(this.el);return I;},getItem:function(E){return this.items[E];},addSeparator:function(){return new Element("span",{"class":"toolbar-separator"}).inject(this.el);},itemAction:function(){this.fireEvent("itemAction",arguments);},disable:function(E){$each(this.items,function(F){(F.name==E)?F.activate():F.deactivate().disable();});return this;},enable:function(){$each(this.items,function(E){E.enable();});return this;},show:function(){this.el.setStyle("display","");return this;},hide:function(){this.el.setStyle("display","none");return this;}});MooEditable.UI.Button=new Class({Implements:[Events,Options],options:{title:"",name:"",text:"Button","class":"",shortcut:"",mode:"icon"},initialize:function(E){this.setOptions(E);this.name=this.options.name;this.render();},toElement:function(){return this.el;},render:function(){var F=this;var G=(Browser.Platform.mac)?"Cmd":"Ctrl";var E=(this.options.shortcut)?" ( "+G+"+"+this.options.shortcut.toUpperCase()+" )":"";var I=this.options.title||name;var H=I+E;this.el=new Element("button",{"class":"mooeditable-ui-button "+F.options["class"],title:H,html:'<span class="button-icon"></span><span class="button-text">'+I+"</span>",events:{click:F.click.bind(F),mousedown:function(J){J.preventDefault();}}});if(this.options.mode!="icon"){this.el.addClass("mooeditable-ui-button-"+this.options.mode);}this.active=false;this.disabled=false;if(Browser.Engine.trident){this.el.addEvents({mouseenter:function(J){this.addClass("hover");},mouseleave:function(J){this.removeClass("hover");}});}return this;},click:function(E){E.preventDefault();if(this.disabled){return ;}this.action(E);},action:function(){this.fireEvent("action",[this].concat($A(arguments)));},enable:function(){if(this.active){this.el.removeClass("onActive");}if(!this.disabled){return ;}this.disabled=false;this.el.removeClass("disabled").set({disabled:false,opacity:1});return this;},disable:function(){if(this.disabled){return ;}this.disabled=true;this.el.addClass("disabled").set({disabled:true,opacity:0.4});return this;},activate:function(){if(this.disabled){return ;}this.active=true;this.el.addClass("onActive");return this;},deactivate:function(){this.active=false;this.el.removeClass("onActive");return this;}});MooEditable.UI.Dialog=new Class({Implements:[Events,Options],options:{"class":"",contentClass:""},initialize:function(G,F){this.setOptions(F);this.html=G;var E=this;this.el=new Element("div",{"class":"mooeditable-ui-dialog "+E.options["class"],html:'<div class="dialog-content '+E.options.contentClass+'">'+G+"</div>",styles:{display:"none"},events:{click:E.click.bind(E)}});},toElement:function(){return this.el;},click:function(){this.fireEvent("click",arguments);return this;},open:function(){this.el.setStyle("display","");this.fireEvent("open",this);return this;},close:function(){this.el.setStyle("display","none");this.fireEvent("close",this);return this;}});MooEditable.UI.AlertDialog=function(F){if(!F){return ;}var E=F+' <button class="dialog-ok-button">'+MooEditable.lang.get("ok")+"</button>";return new MooEditable.UI.Dialog(E,{"class":"mooeditable-alert-dialog",onOpen:function(){var G=this.el.getElement(".dialog-ok-button");(function(){G.focus();}).delay(10);},onClick:function(G){G.preventDefault();if(G.target.tagName.toLowerCase()!="button"){return ;}if($(G.target).hasClass("dialog-ok-button")){this.close();}}});};MooEditable.UI.PromptDialog=function(G,H,F){if(!G){return ;}var E='<label class="dialog-label">'+G+' <input type="text" class="text dialog-input" value="'+H+'"></label> <button class="dialog-button dialog-ok-button">'+MooEditable.lang.get("ok")+'</button><button class="dialog-button dialog-cancel-button">'+MooEditable.lang.get("cancel")+"</button>";return new MooEditable.UI.Dialog(E,{"class":"mooeditable-prompt-dialog",onOpen:function(){var I=this.el.getElement(".dialog-input");(function(){I.focus();I.select();}).delay(10);},onClick:function(L){L.preventDefault();if(L.target.tagName.toLowerCase()!="button"){return ;}var J=$(L.target);var I=this.el.getElement(".dialog-input");if(J.hasClass("dialog-cancel-button")){I.set("value",H);this.close();}else{if(J.hasClass("dialog-ok-button")){var K=I.get("value");I.set("value",H);this.close();if(F){F.attempt(K,this);}}}}});};MooEditable.Actions=new Hash({bold:{title:MooEditable.lang.get("bold"),options:{shortcut:"b"},states:{tags:["b","strong"],css:{"font-weight":"bold"}},events:{beforeToggleView:function(){if(Browser.Engine.gecko){var E=this.textarea.get("value");var F=E.replace(/<strong([^>]*)>/gi,"<b$1>").replace(/<\/strong>/gi,"</b>");if(E!=F){this.textarea.set("value",F);}}},attach:function(){if(Browser.Engine.gecko){var E=this.textarea.get("value");var F=E.replace(/<strong([^>]*)>/gi,"<b$1>").replace(/<\/strong>/gi,"</b>");if(E!=F){this.textarea.set("value",F);this.setContent(F);}}}}},italic:{title:MooEditable.lang.get("italic"),options:{shortcut:"i"},states:{tags:["i","em"],css:{"font-style":"italic"}},events:{beforeToggleView:function(){if(Browser.Engine.gecko){var E=this.textarea.get("value");var F=E.replace(/<embed([^>]*)>/gi,"<tmpembed$1>").replace(/<em([^>]*)>/gi,"<i$1>").replace(/<tmpembed([^>]*)>/gi,"<embed$1>").replace(/<\/em>/gi,"</i>");if(E!=F){this.textarea.set("value",F);}}},attach:function(){if(Browser.Engine.gecko){var E=this.textarea.get("value");var F=E.replace(/<embed([^>]*)>/gi,"<tmpembed$1>").replace(/<em([^>]*)>/gi,"<i$1>").replace(/<tmpembed([^>]*)>/gi,"<embed$1>").replace(/<\/em>/gi,"</i>");if(E!=F){this.textarea.set("value",F);this.setContent(F);}}}}},underline:{title:MooEditable.lang.get("underline"),options:{shortcut:"u"},states:{tags:["u"],css:{"text-decoration":"underline"}}},strikethrough:{title:MooEditable.lang.get("strikethrough"),options:{shortcut:"s"},states:{tags:["s","strike"],css:{"text-decoration":"line-through"}}},insertunorderedlist:{title:MooEditable.lang.get("unorderedList"),states:{tags:["ul"]}},insertorderedlist:{title:MooEditable.lang.get("orderedList"),states:{tags:["ol"]}},indent:{title:MooEditable.lang.get("indent"),states:{tags:["blockquote"]}},outdent:{title:MooEditable.lang.get("outdent")},undo:{title:MooEditable.lang.get("undo"),options:{shortcut:"z"}},redo:{title:MooEditable.lang.get("redo"),options:{shortcut:"y"}},unlink:{title:MooEditable.lang.get("removeHyperlink")},createlink:{title:MooEditable.lang.get("addHyperlink"),options:{shortcut:"l"},states:{tags:["a"]},dialogs:{alert:MooEditable.UI.AlertDialog.pass(MooEditable.lang.get("selectTextHyperlink")),prompt:function(E){return MooEditable.UI.PromptDialog(MooEditable.lang.get("enterURL"),"http://",function(F){E.execute("createlink",false,F.trim());});}},command:function(){var F=this.selection;var H=this.dialogs.createlink;if(F.isCollapsed()){var G=F.getNode();if(G.get("tag")=="a"&&G.get("href")){F.selectNode(G);var E=H.prompt;E.el.getElement(".dialog-input").set("value",G.get("href"));E.open();}else{H.alert.open();}}else{var I=F.getText();var E=H.prompt;if(D.test(I)){E.el.getElement(".dialog-input").set("value",I);}E.open();}}},urlimage:{title:MooEditable.lang.get("addImage"),options:{shortcut:"m"},dialogs:{prompt:function(E){return MooEditable.UI.PromptDialog(MooEditable.lang.get("enterImageURL"),"http://",function(F){E.execute("insertimage",false,F.trim());});}},command:function(){this.dialogs.urlimage.prompt.open();}},toggleview:{title:MooEditable.lang.get("toggleView"),command:function(){(this.mode=="textarea")?this.toolbar.enable():this.toolbar.disable("toggleview");this.toggleView();}}});MooEditable.Actions.Settings={};Element.Properties.mooeditable={set:function(E){return this.eliminate("mooeditable").store("mooeditable:options",E);},get:function(E){if(E||!this.retrieve("mooeditable")){if(E||!this.retrieve("mooeditable:options")){this.set("mooeditable",E);}this.store("mooeditable",new MooEditable(this,this.retrieve("mooeditable:options")));}return this.retrieve("mooeditable");}};Element.implement({mooEditable:function(E){return this.get("mooeditable",E);}});})();MooEditable.UI.ButtonOverlay=new Class({Extends:MooEditable.UI.Button,options:{overlayHTML:"",overlayClass:"",overlaySize:{x:150,y:"auto"},overlayContentClass:""},initialize:function(A){this.parent(A);this.render();this.el.addClass("mooeditable-ui-buttonOverlay");this.renderOverlay(this.options.overlayHTML);},renderOverlay:function(B){var A=this;this.overlay=new Element("div",{"class":"mooeditable-ui-button-overlay "+A.name+"-overlay "+A.options.overlayClass,html:'<div class="overlay-content '+A.options.overlayContentClass+'">'+B+"</div>",tabindex:0,styles:{left:"-999em",position:"absolute",width:A.options.overlaySize.x,height:A.options.overlaySize.y},events:{mousedown:A.clickOverlay.bind(A),focus:A.openOverlay.bind(A),blur:A.closeOverlay.bind(A)}}).inject(document.body).store("MooEditable.UI.ButtonOverlay",this);this.overlayVisible=false;window.addEvent("resize",function(){if(A.overlayVisible){A.positionOverlay();}});},openOverlay:function(){if(this.overlayVisible){return ;}this.overlayVisible=true;this.activate();this.fireEvent("openOverlay",this);return this;},closeOverlay:function(){if(!this.overlayVisible){return ;}this.overlay.setStyle("left","-999em");this.overlayVisible=false;this.deactivate();this.fireEvent("closeOverlay",this);return this;},clickOverlay:function(A){if(A.target==this.overlay||A.target.parentNode==this.overlay){return ;}this.overlay.blur();A.preventDefault();this.action(A);},click:function(A){A.preventDefault();if(this.disabled){return ;}if(this.overlayVisible){this.overlay.blur();return ;}else{this.positionOverlay();this.overlay.focus();}},positionOverlay:function(){var A=this.el.getCoordinates();this.overlay.setStyles({top:A.bottom,left:A.left});return this;}});if(!(!document.getBoxObjectFor&&window.mozInnerScreenX==null)){Browser.Engine={name:"gecko",version:((document.getElementsByClassName)?19:18)};}if(window.ActiveXObject){Browser.Engine={name:"trident",version:((window.XMLHttpRequest)?((document.querySelectorAll)?6:5):4)};}Browser.Engine[Browser.Engine.name]=Browser.Engine[Browser.Engine.name+Browser.Engine.version]=true;var protectRegex=/<(script|noscript|style)[\u0000-\uFFFF]*?<\/(script|noscript|style)>/g;var smileyImgRegexp=/(?:&nbsp;)?<img\s[^<>]*?smileytype=\"?([^<>]*?)\"(\s[^<>]*)?\/?>(?:&nbsp;)?/gi;var blockEls=/^(H[1-6]|HR|P|DIV|ADDRESS|PRE|FORM|TABLE|LI|OL|UL|TD|CAPTION|BLOCKQUOTE|CENTER|DL|DT|DD|SCRIPT|NOSCRIPT|STYLE)$/i;var removeElemStart=/<H[1-6]|HR|P|DIV|ADDRESS|PRE|FORM|TABLE|LI|OL|UL|TD|CAPTION|BLOCKQUOTE|CENTER|DL|DT|DD|SCRIPT|NOSCRIPT|STYLE(\s[^>]*)?>/gi;var removeElemEnd=/<\/H[1-6]|HR|P|DIV|ADDRESS|PRE|FORM|TABLE|LI|OL|UL|TD|CAPTION|BLOCKQUOTE|CENTER|DL|DT|DD|SCRIPT|NOSCRIPT|STYLE(\s[^>]*)?>/gi;var removeAllElemStart=/<[^>]*>/gi;var removeAllElemEnd=/<\/[^>]*>/gi;MooEditable.Actions.Settings.smiley={pathPrefix:"http://i.i.com.com/cnwk.1d/",smileys:{angry:{bbs:"X-(",className:"sprite-angry",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/angry.gif"},blush:{bbs:":8}",className:"sprite-blush",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/blush.gif"},confused:{bbs:"?:|",className:"sprite-confused",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/confused.gif"},cool:{bbs:"B-)",className:"sprite-cool",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/cool.gif"},cry:{bbs:":_|",className:"sprite-cry",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/cry.gif"},devil:{bbs:"]:)",className:"sprite-devil",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/devil.gif"},grin:{bbs:":D",className:"sprite-grin",imgsrc:"http://www.cnet.com/i/mb/emoticons/grin.gif"},happy:{bbs:":-)",className:"sprite-happy",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/happy.gif"},laugh:{bbs:":^0",className:"sprite-laugh",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/laugh.gif"},love:{bbs:":x",className:"sprite-love",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/love.gif"},mischief:{bbs:";\\",className:"sprite-mischief",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/mischief.gif"},plain:{bbs:":|",className:"sprite-plain",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/plain.gif"},sad:{bbs:":-(",className:"sprite-sad",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/sad.gif"},shocked:{bbs:":0",className:"sprite-shocked",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/shocked.gif"},silly:{bbs:":p",className:"sprite-silly",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/silly.gif"},wink:{bbs:";-)",className:"sprite-wink",imgsrc:"http://i.i.com.com/cnwk.1d/i/mb/emoticons/wink.gif"}}};MooEditable.CNET=new Class({Extends:MooEditable,options:{actions:"BBS_bold BBS_italic BBS_underline | undo redo | BBS_createlink BBS_unlink |  smiley | toggleview",paragraphise:false,handleSubmit:false,rootElement:"",semantics:true,baseCSS:"html{ height: 100%; cursor: text; background: #FFF} body{font: 90.5% Arial,Helvetica,sans-serif }",injectIframe:"before",onAttach:function(A){A.doc.body.addListener("paste",this.cleanPaste.bind(this));}},getContent:function(){var A=this.protectedElements;var C=MooEditable.Actions.Settings.smiley;var D="";if(this.doc.body!=null){var B=this.doc.body.get("html").replace(/<!-- mooeditable:protect:([0-9]+) -->/g,function(F,E){return A[E.toInt()];});D=this.cleanup(this.ensureRootElement(B));D=D.replace(/\n</gi,"<");D=D.replace(/<strong(\s[^>]*)?>/gi,"[b]").replace(/<\/strong>/gi,"[/b]");D=D.replace(/<em(\s[^>]*)?>/gi,"[i]").replace(/<\/em>/gi,"[/i]");D=D.replace(/<span\s[^<>]*?style=\"?text-decoration: ?underline;?\"?\s*>/gi,"<u>");D=D.replace(/<\/span>/gi,"</u>");D=D.replace(/<u(\s[^>]*)?>/gi,"[u]").replace(/<\/u>/gi,"[/u]");D=D.replace(/<p(\s[^>]*)?>/gi,"");D=D.replace(/<\/p>/gi,"\n");D=D.replace(/<br(\s[^>]*)?>/gi,"\n");D=D.replace(/<a\s[^<>]*?href=\"?([^<>]*?)\"?(\s[^<>]*)?>([^<>]*?)<\/a>/gi,"[url=$1]$3[/url]");D=D.replace(smileyImgRegexp,function(E,G,F){return" "+C.smileys[G].bbs+" ";});D=D.replace(/&nbsp;/gi," ");}return D;},setContent:function(C){var B=MooEditable.Actions.Settings.smiley;$each(B.smileys,function(D){var E="(\\s|^)"+D.bbs.escapeRegExp()+"(\\s|$)";C=C.replace(new RegExp(E,"g"),'&nbsp;<img style="border:0;" class="smiley" smileytype="'+D.className.replace(/sprite-/,"")+'" src="'+D.imgsrc+'"/>&nbsp;');});C=C.replace(/\[b\]/gi,"<strong>").replace(/\[\/b\]/gi,"</strong>");C=C.replace(/\[i\]/gi,"<em>").replace(/\[\/i\]/gi,"</em>");C=C.replace(/\[u\]/gi,"<u>").replace(/\[\/u\]/gi,"</u>");C=C.replace(/\[url=([^\]]+)\]([\s\S]*?)\[\/url\]/gi,'<a href="$1">$2</a>').replace(/\[url\]([\s\S]*?)\[\/url\]/gi,'<a href="$1">$1</a>');C=C.replace(/\n/gi,"<br />");C=C.replace(/ (?= )/g,"&nbsp;");var A=this.protectedElements;C=C.replace(protectRegex,function(D){A.push(D);return"<!-- mooeditable:protect:"+(A.length-1)+" -->";});if(this.doc.body!=null){this.doc.body.set("html",this.ensureRootElement(C));}return this;},editorKeyUp:function(A){if(this.editorDisabled){A.stop();return ;}$clear(this.checkStatesDelay);this.checkStatesDelay=this.checkStates.delay(250,this);this.fireEvent("editorKeyUp",[A,this]);},checkStates:function(){var A=this.selection.getNode();if(!A){return ;}if($type(A)!="element"){return ;}this.actions.each(function(E){var H=this.toolbar.getItem(E);if(!H){return ;}H.deactivate();var I=MooEditable.Actions[E]["states"];if(!I){return ;}if($type(I)=="function"){I.attempt([$(A),H],this);return ;}try{var D=this.doc.queryCommandState(E.replace("BBS_",""));if(D){H.activate();return ;}}catch(G){}if(I.tags){var C=A;do{var K=C.tagName.toLowerCase();if(I.tags.contains(K)){H.activate(K);break;}}while((C=Element.getParent(C))!=null);}if(I.css){var C=A;do{var J=false;for(var B in I.css){var F=I.css[B];if(Element.getStyle(C,B).contains(F)){H.activate(F);J=true;}}if(J||C.tagName.test(blockEls)){break;}}while((C=Element.getParent(C))!=null);}}.bind(this));},cleanPaste:function(B){var A=B.clipboardData&&B.clipboardData.getData?B.clipboardData.getData("text/html"):window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):false;if(!!A){this.selection.insertContent(this.cleanHtml(A));new Event(B).stop();}else{this.selection.insertContent('<span id="INSERTION_MARKER">&nbsp;</span>');this.txtMarked=this.doc.body.get("html");this.doc.body.set("html","");this.replaceMarkerWithPastedText.delay(5,this);}return this;},replaceMarkerWithPastedText:function(){var A=this.doc.body.get("html");var C=this.cleanHtml(A);this.doc.body.set("html",this.txtMarked);var B=this.doc.body.getElementById("INSERTION_MARKER");this.selection.selectNode(B);this.selection.insertContent(C);return this;},cleanHtml:function(A){A=A.replace(removeAllElemStart,"");A=A.replace(removeAllElemEnd,"");A=A.replace(/<o:p>\s*<\/o:p>/g,"");A=A.replace(/<o:p>[\s\S]*?<\/o:p>/g,"&nbsp;");A=A.replace(/\s*mso-[^:]+:[^;"]+;?/gi,"");A=A.replace(/\s*MARGIN: 0cm 0cm 0pt\s*;/gi,"");A=A.replace(/\s*MARGIN: 0cm 0cm 0pt\s*"/gi,'"');A=A.replace(/\s*TEXT-INDENT: 0cm\s*;/gi,"");A=A.replace(/\s*TEXT-INDENT: 0cm\s*"/gi,'"');A=A.replace(/\s*TEXT-ALIGN: [^\s;]+;?"/gi,'"');A=A.replace(/\s*PAGE-BREAK-BEFORE: [^\s;]+;?"/gi,'"');A=A.replace(/\s*FONT-VARIANT: [^\s;]+;?"/gi,'"');A=A.replace(/\s*tab-stops:[^;"]*;?/gi,"");A=A.replace(/\s*tab-stops:[^"]*/gi,"");A=A.replace(/\s*face="[^"]*"/gi,"");A=A.replace(/\s*face=[^ >]*/gi,"");A=A.replace(/\s*FONT-FAMILY:[^;"]*;?/gi,"");A=A.replace(/<(\w[^>]*) class=([^ |>]*)([^>]*)/gi,"<$1$3");A=A.replace(/<(\w[^>]*) style="([^\"]*)"([^>]*)/gi,"<$1$3");A=A.replace(/<STYLE[^>]*>[\s\S]*?<\/STYLE[^>]*>/gi,"");A=A.replace(/<(?:META|LINK)[^>]*>\s*/gi,"");A=A.replace(/\s*style="\s*"/gi,"");A=A.replace(/<SPAN\s*[^>]*>\s*&nbsp;\s*<\/SPAN>/gi,"&nbsp;");A=A.replace(/<SPAN\s*[^>]*><\/SPAN>/gi,"");A=A.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3");A=A.replace(/<SPAN\s*>([\s\S]*?)<\/SPAN>/gi,"$1");A=A.replace(/<FONT\s*>([\s\S]*?)<\/FONT>/gi,"$1");A=A.replace(/<\\?\?xml[^>]*>/gi,"");A=A.replace(/<w:[^>]*>[\s\S]*?<\/w:[^>]*>/gi,"");A=A.replace(/<\/?\w+:[^>]*>/gi,"");A=A.replace(/<\!--[\s\S]*?-->/g,"");A=A.replace(/<(U|I|STRIKE)>&nbsp;<\/\1>/g,"&nbsp;");A=A.replace(/<H\d>\s*<\/H\d>/gi,"");A=A.replace(/<(\w+)[^>]*\sstyle="[^"]*DISPLAY\s?:\s?none[\s \S]*?<\/\1>/ig,"");A=A.replace(/<(\w[^>]*) language=([^ |>]*)([^>]*)/gi,"<$1$3");A=A.replace(/<(\w[^>]*) onmouseover="([^\"]*)"([^>]*)/gi,"<$1$3");A=A.replace(/<(\w[^>]*) onmouseout="([^\"]*)"([^>]*)/gi,"<$1$3");A=A.replace(/<H(\d)([^>]*)>/gi,"<h$1>");A=A.replace(/<(H\d)><FONT[^>]*>([\s\S]*?)<\/FONT><\/\1>/gi,"<$1>$2</$1>");A=A.replace(/<(H\d)><EM>([\s\S]*?)<\/EM><\/\1>/gi,"<$1>$2</$1>");A=A.replace(/<\s+[^>]*>/gi,"");A=A.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"");A=A.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"");A=A.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"");if(!this.options.paragraphise){A.replace(/<p>/gi,"<br />");A.replace(/<\\p>/gi,"");}return A;},attach:function(){var A=this;this.mode="iframe";this.editorDisabled=false;this.container.wraps(this.textarea);this.textarea.setStyle("display","none");this.iframe.setStyle("display","").inject(this.textarea,this.options.injectIframe);$each(this.dialogs,function(E,D){$each(E,function(G){$(G).inject(A.iframe,"before");var F;G.addEvents({open:function(){F=A.selection.getRange();A.editorDisabled=true;A.toolbar.disable(D);A.fireEvent("dialogOpen",this);},close:function(){A.toolbar.enable();A.editorDisabled=false;A.focus();if(F){A.selection.setRange(F);}A.fireEvent("dialogClose",this);}});});});this.win=this.iframe.contentWindow;this.doc=this.win.document;if(Browser.firefox){this.doc.designMode="On";}var C=this.options.html.substitute({BASECSS:this.options.baseCSS,EXTRACSS:this.options.extraCSS,EXTERNALCSS:(this.options.externalCSS)?'<link rel="stylesheet" href="'+this.options.externalCSS+'">':"",BASEHREF:(this.options.baseURL)?'<base href="'+this.options.baseURL+'" />':""});this.doc.open();this.doc.write(C);this.doc.close();(Browser.Engine.trident)?this.doc.body.contentEditable=true:this.doc.designMode="On";if(!this.win.$family){new Window(this.win);}if(!this.doc.$family){new Document(this.doc);}$(this.doc.body);this.setContent(this.textarea.get("value"));this.doc.addEvents({mouseup:this.editorMouseUp.bind(this),mousedown:this.editorMouseDown.bind(this),mouseover:this.editorMouseOver.bind(this),mouseout:this.editorMouseOut.bind(this),mouseenter:this.editorMouseEnter.bind(this),mouseleave:this.editorMouseLeave.bind(this),contextmenu:this.editorContextMenu.bind(this),click:this.editorClick.bind(this),dblclick:this.editorDoubleClick.bind(this),keypress:this.editorKeyPress.bind(this),keyup:this.editorKeyUp.bind(this),keydown:this.editorKeyDown.bind(this),focus:this.editorFocus.bind(this),blur:this.editorBlur.bind(this)});this.win.addEvents({focus:this.editorFocus.bind(this),blur:this.editorBlur.bind(this)});["cut","copy","paste"].each(function(D){A.doc.body.addListener(D,A["editor"+D.capitalize()].bind(A));});this.textarea.addEvent("keypress",this.textarea.retrieve("mooeditable:textareaKeyListener",this.keyListener.bind(this)));if(Browser.Engine.gecko&&Browser.Engine.version==18){this.doc.addEvent("focus",function(){A.win.fireEvent("focus").focus();});}if(!(/trident|presto/i).test(Browser.Engine.name)){var B=function(){A.execute("styleWithCSS",false,false);A.doc.removeEvent("focus",B);};this.win.addEvent("focus",B);}if(this.options.toolbar){$(this.toolbar).inject(this.container,"top");this.toolbar.render(this.actions);}if(this.options.disabled){this.disable();}this.selection=new MooEditable.Selection(this.win);this.oldContent=this.getContent();this.fireEvent("attach",this);return this;}});MooEditable.lang.set({bbs_bold:"Bold",bbs_italic:"Italic",bbs_underline:"Underline",bbs_removeHyperlink:"Remove Hyperlink",bbs_addHyperlink:"Add Hyperlink",bbs_selectTextHyperlink:"Please select the text you wish to hyperlink.",bbs_enterURL:"Enter URL",insertSmiley:"Insert Smiley"});MooEditable.UI.Button=new Class({Implements:[Events,Options],options:{title:"",name:"",text:"Button","class":"",shortcut:"",mode:"icon"},initialize:function(A){this.setOptions(A);this.name=this.options.name;this.render();},toElement:function(){return this.el;},render:function(){var B=this;var C=(Browser.Platform.mac)?"Cmd":"Ctrl";var A=(this.options.shortcut)?" ( "+C+"+"+this.options.shortcut.toUpperCase()+" )":"";var E=this.options.title||name;var D=E+A;this.el=new Element("button",{"class":"mooeditable-ui-button "+B.options["class"],title:D,tabindex:-1,html:'<span class="button-icon"></span><span class="button-text">'+E+"</span>",events:{click:B.click.bind(B),mousedown:function(F){F.preventDefault();}}});if(this.options.mode!="icon"){this.el.addClass("mooeditable-ui-button-"+this.options.mode);}this.active=false;this.disabled=false;if(Browser.Engine.trident){this.el.addEvents({mouseenter:function(F){this.addClass("hover");},mouseleave:function(F){this.removeClass("hover");}});}return this;},click:function(A){A.preventDefault();if(this.disabled){return ;}this.action(A);},action:function(){this.fireEvent("action",[this].concat($A(arguments)));},enable:function(){if(this.active){this.el.removeClass("onActive");}if(!this.disabled){return ;}this.disabled=false;this.el.removeClass("disabled").set({disabled:false,opacity:1});return this;},disable:function(){if(this.disabled){return ;}this.disabled=true;this.el.addClass("disabled").set({disabled:true,opacity:0.4});return this;},activate:function(){if(this.disabled){return ;}this.active=true;this.el.addClass("onActive");return this;},deactivate:function(){this.active=false;this.el.removeClass("onActive");return this;}});MooEditable.UI.ButtonOverlay=new Class({Extends:MooEditable.UI.Button,options:{overlayHTML:"",overlayClass:"",overlaySize:{x:150,y:"auto"},overlayContentClass:""},initialize:function(A){this.parent(A);this.render();this.el.addClass("mooeditable-ui-buttonOverlay");this.renderOverlay(this.options.overlayHTML);},renderOverlay:function(B){var A=this;this.overlay=new Element("div",{"class":"mooeditable-ui-button-overlay "+A.name+"-overlay "+A.options.overlayClass,html:'<div class="overlay-content '+A.options.overlayContentClass+'">'+B+"</div>",tabindex:-1,styles:{left:"-999em",position:"absolute",width:A.options.overlaySize.x,height:A.options.overlaySize.y},events:{mousedown:A.clickOverlay.bind(A),focus:A.openOverlay.bind(A),blur:A.closeOverlay.bind(A)}}).inject(document.body).store("MooEditable.UI.ButtonOverlay",this);this.overlayVisible=false;window.addEvent("resize",function(){if(A.overlayVisible){A.positionOverlay();}});},openOverlay:function(){if(this.overlayVisible){return ;}this.overlayVisible=true;this.activate();this.fireEvent("openOverlay",this);return this;},closeOverlay:function(){if(!this.overlayVisible){return ;}this.overlay.setStyle("left","-999em");this.overlayVisible=false;this.deactivate();this.fireEvent("closeOverlay",this);return this;},clickOverlay:function(A){if(A.target==this.overlay||A.target.parentNode==this.overlay){return ;}this.overlay.blur();A.preventDefault();this.action(A);},click:function(A){A.preventDefault();if(this.disabled){return ;}if(this.overlayVisible){this.overlay.blur();return ;}else{this.positionOverlay();this.overlay.focus();}},positionOverlay:function(){var A=this.el.getCoordinates();this.overlay.setStyles({top:A.bottom,left:A.left});return this;}});MooEditable.Actions.extend({BBS_bold:{title:MooEditable.lang.get("bbs_bold"),command:function(B,A){this.focus();this.execute("bold",false,null);this.checkStates();},options:{shortcut:"b"},states:{}},BBS_italic:{title:MooEditable.lang.get("bbs_italic"),command:function(B,A){this.focus();this.execute("italic",false,null);this.checkStates();},options:{shortcut:"i"},states:{}},BBS_underline:{title:MooEditable.lang.get("bbs_underline"),command:function(B,A){this.focus();this.execute("underline",false,null);this.checkStates();},options:{shortcut:"u"},states:{}},BBS_unlink:{title:MooEditable.lang.get("bbs_removeHyperLink"),command:function(B,A){this.focus();this.execute("unlink",false,null);this.checkStates();}},BBS_createlink:{title:MooEditable.lang.get("bbs_addHyperLink"),options:{shortcut:"l"},states:{tags:["a"]},dialogs:{alert:MooEditable.UI.AlertDialog.pass(MooEditable.lang.get("bbs_selectTextHyperlink")),prompt:function(A){return MooEditable.UI.PromptDialog(MooEditable.lang.get("bbs_enterURL"),"http://",function(B){A.execute("createlink",false,B.trim());});}},command:function(){var B=this.selection;var D=this.dialogs.BBS_createlink;if(B.isCollapsed()){var C=B.getNode();if(C.get("tag")=="a"&&C.get("href")){B.selectNode(C);var A=D.prompt;A.el.getElement(".dialog-input").set("value",C.get("href"));A.open();}else{D.alert.open();}}else{var F=B.getText();var A=D.prompt;var E=/^(https?|ftp|rmtp|mms):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)(:(\d+))?\/?/i;if(E.test(F)){A.el.getElement(".dialog-input").set("value",F);}A.open();}this.checkStates();}},smiley:{type:"button-overlay",title:MooEditable.lang.get("insertSmiley"),options:{onOpenOverlay:function(){if($$(".smileyTips").length==0){new Tips(".smiley-image",{className:"smileyTips"});}},overlaySize:{x:"auto"},overlayHTML:(function(){var B=MooEditable.Actions.Settings.smiley;var A="<ul>";$each(B.smileys,function(C){A+='<li class="smiley-image '+C.className+'" title="'+C.className.replace(/sprite-/gi,"")+'">';});A+="</ul>";return A;})()},command:function(F,E){var C=E.target;if(C.tagName.toLowerCase()!="li"){return ;}var B=MooEditable.Actions.Settings.smiley;var A=$(C).get("class").replace(/smiley-image/gi,"").replace(/sprite-/gi,"").trim();if($defined(B.smileys[A])){var D='&nbsp;<img style="border:0;" class="smiley" smileytype="'+A+'" src="'+B.smileys[A].imgsrc+'" alt="'+A+'">&nbsp;';this.focus();this.selection.insertContent(D);this.saveContent();}},events:{attach:function(A){if(Browser.Engine.trident){A.doc.addListener("controlselect",function(C){var B=C.target;if(B!=null&&B.tagName!=null){if(B!=null&&B.tagName.toLowerCase()!="li"){return ;}if(B!=null&&!$(B).hasClass("smiley")){return ;}if(C.preventDefault){C.preventDefault();}else{C.returnValue=false;}}});}},editorMouseDown:function(D,C){var B=D.target;if(B!=null&&B.tagName!=null){var A=(B!=null&&B.tagName.toLowerCase()=="img")&&$(B).hasClass("smiley");try{C.doc.execCommand("enableObjectResizing",false,!A);}catch(D){C.doc.addEvent("resizeStart",function(E){E.preventDefault();});}}}}}});var ThumbScroller=new Class({Extends:Fx.Scroll,scrollOptions:{thumbs:".box",axis:"x",thumbContainer:null,nav:{},startIndex:0,tolerance:0},initialize:function(A,B){if($(A).retrieve("thumbscroller")){return false;}this.parent(A,$merge(this.scrollOptions,B));this.element.store("thumbscroller",this);this.element.setStyle("overflow","hidden");this.computeDimensions();this.initNav();this.toIndex(this.options.startIndex);this.lastScroll=null;this.fireEvent("onInitialize");return this;},computeDimensions:function(){this.thumbs=this.element.getElements(this.options.thumbs);this.setParentSize();this.positions=this.getLocations();return this;},isAtEnd:function(A){A=A||this.getRange();var B=A[A.length-1];return(B.index==this.thumbs.length-1&&(B.type!="partial"||B.tolerated));},isAtStart:function(A){A=A||this.getRange();var B=A[0];return(B.index==0&&(B.type!="partial"||B.tolerated));},getLocations:function(){return this.thumbs.map(function(B){var C=B.getComputedSize()[this.getDir("total")];var A=B.getPosition(B.getParent())[this.getDir("xy")];return{size:C,start:A,end:C+A};},this);},initNav:function(){$$(this.options.nav.next).addEvent("click",this.toNextScreen.bind(this));$$(this.options.nav.previous).addEvent("click",this.toPreviousScreen.bind(this));$$(this.options.nav.start).addEvent("click",this.toStart.bind(this));$$(this.options.nav.end).addEvent("click",this.toEnd.bind(this));},getDir:function(A){switch(A){case"total":if(this.options.axis=="y"){return"totalHeight";}return"totalWidth";case"dir":if(this.options.axis=="y"){return"height";}return"width";case"xy":default:if(this.options.axis=="y"){return"y";}return"x";}},getStart:function(A){if(this.options.axis=="y"){return[0,A];}return[A,0];},getStartPx:function(A){if(!A){return 0;}return this.positions[A].start-(this.positions[A].start-this.positions[A-1].end);},setParentSize:function(){var A=(this.options.thumbContainer)?this.element.getElement(this.options.thumbContainer):this.element.getElement(this.options.thumbs).getParent();var B=0;$each(this.thumbs,function(C){B+=C.getComputedSize({styles:["padding","border","margin"]})[this.getDir("total")];},this);A.setStyle(this.getDir("dir"),B);},getRange:function(E){if(isNaN(E)){E=this.element.getScroll()[this.getDir("xy")];}var D=this.element.getComputedSize({styles:["padding"]})[this.getDir("total")];var C=[];for(var A=0;A<this.positions.length;A++){var B=this.withinRange(this.positions[A],E,E+D);if(B){C.push($merge(B,{index:A}));if(B.where=="end"){break;}}}return C;},withinRange:function(C,B,A){if(C.end>B&&C.end<=A){if(C.start>=B){return{type:"full"};}else{return{type:"partial",where:"start",tolerated:((B-C.start)<=this.options.tolerance)};}}else{if(C.start>=B&&C.start<A){return{type:"partial",where:"end",tolerated:((C.start-A)<this.options.tolerance)};}else{if(C.start<B&&C.end>A){return{type:"full"};}}}return false;},toNextScreen:function(){var A=this.getRange();if(A.getLast().type=="partial"&&!A.getLast().tolerated&&A.length>1){this.start.run(this.getStart(this.getStartPx(A.getLast().index)),this);}else{if($(this.thumbs[A.getLast().index+1])){this.start.run(this.getStart(this.getStartPx(A.getLast().index+1)),this);}else{this.toEnd();}}this.lastScroll="next";},toPreviousScreen:function(){var A=this.getRange();var C=(A[0].type=="partial"&&!A[0].tolerated&&A.length>1)?A[0].index:A[0].index-1;if(!this.positions[C]){this.toStart();return ;}var B=this.positions[C].end-this.element.getComputedSize({styles:["padding"]})[this.getDir("total")];var E=this.getRange(B);var D=(E[0].type=="partial"&&E.length>1)?E[0].index+1:E[0].index;this.start.run(this.getStart(this.getStartPx(D)),this);this.lastScroll="previous";},toIndex:function(A){this.start.run(this.getStart(this.getStartPx(parseInt(A))),this);},toStart:function(){if(this.options.axis=="y"){this.toTop();}else{this.toLeft();}},toEnd:function(){if(this.options.axis=="y"){this.toBottom();}else{this.toRight();}}});var QuickTabs=new Class({Implements:Options,options:{nextAction:null,params:{viewType:"json",activityName:"quickTabUpdate",requestedTilesLike:"quickTabElement",keywordFilterOverride:null,nomesh:""},oid:{domain:window.location.host,pagetype:"2724",node:PageVars.get("nodeId")},tabParams:{},filterTag$$:".filterTag"},initialize:function(B,A){dbug.log("Initializing QuickTabs.");this.elements=B;this.setOptions(A);this.grabQuickTabData();this.initFilters();$$(this.elements+" ul.quickTabBar li").addEvent("click",function(C){if(!C.target.hasClass("selected")){this.goToTab(C.target);}}.bind(this));$$(this.elements+" ul.quickTab .showNext span").addEvent("click",function(C){this.updateTab(C.target,"append");}.bind(this));this.nextAction();},grabQuickTabData:function(){$$(this.elements+" ul.quickTab li.quickTabData").each(function(A){A.getParent("ul.quickTab").set("limit",A.get("limit"));A.getParent("ul.quickTab").set("start",A.get("start"));A.dispose();}.bind(this));},setTabVars:function(A){if(A!=null&&!isNaN(parseInt(A.get("asset")))&&!isNaN(parseInt(A.get("start")))&&!isNaN(parseInt(A.get("tab")))){this.options.oid.asset=A.get("asset");this.options.tabParams={};this.options.tabParams.assetStartOverride=A.get("start");this.options.tabParams.assetLimitOverride=A.get("limit");this.options.tabParams.requestedTab=A.get("tab");}else{this.options.tabParams=null;}},updateTab:function(C,A){var D=null;if(A=="append"){D=C.getParent(".quickTab");}else{if(A=="filter"){D=C.getParent(".filterTagBar").getParent().getElements(".quickTab.selected")[0];}else{dbug.log("QuickTab fetch type invalid!");return false;}}var B=new Waiter(D);B.start();this.setTabVars(D);if(A=="filter"&&this.options.tabParams!=null){this.options.tabParams.requestedTab=null;this.options.tabParams.assetStartOverride=0;}if(D!=null&&this.options.tabParams!=null){dbug.log("Making QuickTab request.");new Request.JSON({url:"http://"+this.options.oid.domain+"/"+this.options.oid.pagetype+"-"+this.options.oid.node+"-"+this.options.oid.asset+".html",data:$merge(this.options.params,this.options.tabParams),method:"get",onSuccess:function(E,F){dbug.log("Received QuickTab response.");try{if(A=="append"){this.appendResponse(D,E.RiaResponse.pageElement);}else{if(A=="filter"){this.filterResponse(D.getParent(),E.RiaResponse.pageElement);}}}catch(G){dbug.log("QuickTab response processing failed!");this.disableAjax(D);}}.bind(this),onFailure:function(){dbug.log("QuickTab request failed.");this.disableAjax(D);}}).send();}else{dbug.log("Insufficient data to make QuickTab request.");this.disableAjax(D);}B.stop();},appendResponse:function(E,D){var B=null;if(D instanceof Array){B=D[this.options.tabParams.requestedTab];}else{if(this.options.tabParams.requestedTab=="0"){B=D;}}if(B!=null&&B.html!=null&&B.html.$!=null&&B.html.$!=""){var F=new Element("div",{html:B.html.$});var A=null;var C=E.getChildren("li.asset");if(C.length>0){A=C[C.length-1];}if(A!=null){F.getChildren().each(function(G){G.inject(A,"after");C=E.getChildren("li.asset");A=C[C.length-1];});if(E.getElements(".cta")!=null&&E.getElements(".cta").length>0){this.disableAjax(E);}E.set("start",parseInt(E.get("start"))+parseInt(E.get("limit")));dbug.log("QuickTab update complete.");this.nextAction();}else{dbug.log("QuickTab content update failed!");this.disableAjax(E);}}else{dbug.log("QuickTab response empty!");this.disableAjax(E);}new Jlogger({cval:"quickTabs;ajaxMore;component"+this.options.oid.asset,ctype:"testevent;click"}).ping();},filterResponse:function(B,C){var A=null,D=null;B.getChildren(".quickTab").each(function(G,E){G.set("start",G.get("limit"));if(C instanceof Array){A=C[E];}else{A=C;}if(A!=null&&A.html!=null&&A.html.$!=null){D=new Element("div",{html:A.html.$});var F=G.getChildren("li.asset");if(F.length>0){F.dispose();}D.getChildren().each(function(H){var I=G.getChildren("li.asset");if(I!=null&&I.length>0){H.inject(I[I.length-1],"after");}else{H.inject(G,"top");}});if(G.getElements(".cta")!=null&&G.getElements(".cta").length>0){new Jlogger({tag:"noContentOnFilter"}).ping();this.disableAjax(G);}dbug.log("QuickTab filter tab "+E+" complete.");this.nextAction();}else{dbug.log("Quicktab filter tab "+E+" failed.");}}.bind(this));new Jlogger({cval:"quickTabs;filter;"+this.options.params.keywordFilterOverride,ctype:"testevent;click"}).ping();},disableAjax:function(B){if(B.getChildren(".showNext").length>0){try{var A=B.getParent().getElements(".sectionHed p a.readMore")[0];A=new Element("a",{href:A.get("href"),html:A.get("text"),"class":"noMore"});}catch(C){A=new Element("span",{html:"No more to display","class":"noMore"});}B.getChildren(".showNext").each(function(D){D.getChildren().hide();});A.inject(B.getChildren(".showNext")[0]);}},enableAjax:function(A){A.getChildren(".showNext").getChildren("noMore").dispose();A.getChildren(".showNext").getChildren().show();},goToTab:function(A){dbug.log("Going to QuickTab.");A.getParent(".quickTabBar").getChildren("li").each(function(B){if(B==A){B.addClass("selected");}else{B.removeClass("selected");}});A.getParent(".quickTabBar").getParent().getChildren(".quickTab").each(function(B){if(A.get("tab")!=null&&B.get("tab")==A.get("tab")){B.addClass("selected");}else{B.removeClass("selected");}});new Jlogger({cval:"quickTabs;switchTab;tab"+this.options.tabParams.requestedTab,ctype:"testevent;click"}).ping();this.nextAction();},nextAction:function(){try{if(this.options.nextAction!=null){dbug.log("Performing QuickTab next action.");this.options.nextAction();}}catch(A){dbug.log("QuickTab - next action failed!");}},initFilters:function(){dbug.log("Checking QuickTab filters.");var A=window.location.href.split("?");if(A.length>1){var B=A[1].parseQueryString();if(B.filterTag){this.options.params.keywordFilterOverride=B.filterTag;}}if(this.options.filterTag$$&&this.options.filterTag$$!=null){dbug.log("Initiating QuickTab filters.");$$(this.elements+" "+this.options.filterTag$$).addEvent("click",function(C){dbug.log("Filtering QuickTab.");C.stop();var D=new Waiter(C.target);D.start();if(C.target.hasClass("all")){this.options.params.keywordFilterOverride=null;}else{this.options.params.keywordFilterOverride=C.target.get("text");}$$(this.elements+" "+this.options.filterTag$$).each(function(E){if(E.get("text")==this.options.params.keywordFilterOverride||(this.options.params.keywordFilterOverride==null&&E.hasClass("all"))){E.addClass("selected");}else{E.removeClass("selected");}}.bind(this));this.updateTab(C.target,"filter");D.stop();}.bind(this));}dbug.log("Initiating QuickTab filter toggle.");$$(this.elements+" .filterTagBar .expandToggle").addEvent("click",function(){if(this.getParent(".filterTagBar").hasClass("expanded")){this.getParent(".filterTagBar").removeClass("expanded");this.set("text",this.get("text").replace("Collapse","Expand"));}else{this.getParent(".filterTagBar").addClass("expanded");this.set("text",this.get("text").replace("Expand","Collapse"));}});}});var SocialBar=new Class({Implements:Options,options:{listName:"My Saved Articles",isBlogPage:false},loggedInAtLoad:UserVars.get("loggedIn")==1||UserVars.get("rememberMe")==1,buildSaveToList:function(){this.element.getElements(this.wrapper$$+" .saveIcon").each(function(A){A.removeEvents("click");A.addEvent("click",function(B){CURS.Manager.checkLogin({loginHed:"Log in to CNET to add this product to your list",registerHed:"Join CNET to add this product to your list",appId:222,cval:"userlist",nextAction:function(){var E=B.target;var D=E.get("aid");var C=E.get("atype");var F=E.get("aname");var G=E.get("aimage");if(D&&C&&F){new Request.JSON({url:"/8691-"+PageVars.get("nodeId")+"_"+PageVars.get("siteId")+"-0.html?viewType=json",data:{description:"",listItemsJson:'[{"assetId":'+D+',"assetTypeId":'+C+',"name":"'+F+'","image":"'+G+'"}]',listTypeId:"14",name:this.options.listName,isPrivate:"true"},onSuccess:function(H){if(!this.loggedInAtLoad){window.location.reload();}H=H.response;function L(){E.set("html","saved");E.addClass("saved");E.removeProperties("aid","atype","aname","aimage");}if(H.status.$=="success"||H.status.$=="pending"){L();if(this.checkCookie("cnet_savedArticleCallout",2)){CnetToolbar.Base.displaySavedArticleMessage();}}else{if(H.errors.error!=null){if(H.errors.error instanceof Array){var M=H.errors.error;}else{var M=[H.errors.error];}var K=false;for(var I in M){I=M[I];if(!K){for(var J in I){if(J=="@name"&&I[J]=="PRODUCT_ALREADY_EXISTS"){dbug.log("item already exists");K=true;L();}else{if(J=="@name"&&I[J]=="LIST_SIZE_MAX_EXCEEDED_EXCEPTION"){dbug.log("save limit reached");this.displayAlert("Saved Item limit exceeded",'<p>We\'re sorry, but you cannot save more than 100 articles.</p><p>To make room for more, remove one or more from your <a href="http://www.cnet.com/3460-4_1-2.html">Saved Articles list</a>.</p>','<a class="flexButton" href="http://www.cnet.com/3460-4_1-2.html">Manage list</a>');K=true;}}}}}if(!K){dbug.log("list failure");this.displayAlert("Error","<p>We're sorry, but an unexpected error occurred while saving your article. Please try again.</p>");}}}new Jlogger({tag:"saveArticle"}).ping();}.bind(this),onfailure:function(){dbug.log("list failure");this.displayAlert("Error","<p>We're sorry, but an unexpected error occurred while saving your article. Please try again.</p>");},method:"post"}).send();}}.bind(this)});}.bind(this));}.bind(this));},checkCookie:function(C,B){var A=(!Cookie.read(C)||$type(Cookie.read(C).toInt())!="number")?1:Cookie.read(C).toInt()+1;if(A>B){return false;}else{Cookie.write(C,A,{duration:365,domain:".cnet.com",path:"/"});return true;}},displayAlert:function(B,A,C){new StickyWinModal({content:'<div class="globalModal yodaPopup"><div class="formHead clearfix"><h2>'+B+'</h2><a class="closeModal" onclick="this.getParent(\'.StickyWinInstance\').dispose(); $$(\'#modalOverlay\').dispose();">close</a></div><div class="formBody">'+A+'</div><div class="formFooter">'+C+"</div></div>",modalOptions:{modalStyle:{"background-color":"#666666",opacity:0.6}}});},setBlogStats:function(){var A=UserVars.get("ursRegId");this.element.getElements(this.wrapper$$).each(function(D){var B,F;if(!this.options.isBlogPage){B=D.getElements(".comments")[0];if(B!=undefined&&B!=null){F=B.get("aid");var E=B.get("cid");}}else{B=D.getElements(".saveIcon")[0];if(B!=undefined&&B!=null){F=B.get("aid");}}if((F&&E)||(F&&A)){var H=this.options.isBlogPage;var C=new Date();var G=this.loggedInAtLoad;new Request.JSON({url:"/posidn/rest/v1.0/blogRelatedStatsResource",method:"get",data:{viewType:"json",communityId:E,assetId:F,ownerId:A,listItemTypeId:"14","posidn.useSampleValues":"true",refresh:C.getTime()},onSuccess:function(I){I=I.CNETResponse;var M;if(!H){M=this.getElements(".comments")[0];var K=0;if(M!=null){try{for(var J in I.Comments){if(J=="@numFound"){K=I.Comments[J];}}}catch(L){}M.set("text",K+" "+M.get("text"));M.removeProperties("aid","cid");}}if(G&&A!=null){M=this.getElements(".saveIcon")[0];try{for(J in I.ListItems){if(J=="@numFound"&&I.ListItems[J]>0){M.addClass("saved");M.set("text","saved");M.removeProperties("aid","aname","atype");}}}catch(L){}}}.bind(D),onfailure:function(){if(!H){var I=this.getElements(".comments")[0];if(I!=null){I.set("text","0 "+I.get("text"));I.removeProperties("aid","cid");}}}.bind(D)}).send();}}.bind(this));},buildShareIcons:function(){$$(".socialBar a.twitter-share-button").each(function(A){A.hide();});$$(".socialBar .fbShare").each(function(B){try{FB.XFBML.parse(B);}catch(A){}});},initialize:function(B,A){if(B!=undefined){if(PageVars.get("pageType")==8300||PageVars.get("pageType")==8301){this.options.isBlogPage=true;}this.element=B;this.setOptions(A);if(this.options.isBlogPage){this.wrapper$$=".contentTools";}else{this.wrapper$$=".socialBar";}this.buildSaveToList();this.setBlogStats();this.buildShareIcons();}}});window.addEvent("domready",function(){var I=true;var M;var O=(Browser.Engine.name=="trident"&&(Browser.Engine.version==5||Browser.Engine.version==4));var G="Popup";var H=UserVars.get("loggedIn")==1||UserVars.get("rememberMe")==1;$$(".type").addEvent("click",function(Q){$$(".subjectHeading").set("text","Subject title");$$(".bodyHeading").set("text","Message body (required):");$$(".threadTypeForm").setStyle("display","none");if($("firstPollSelection")){$("firstPollSelection").removeClass("validate-minFields");}if(Q.target.id=="typePoll"){$$(".subjectHeading").set("text","Poll question");$$(".pollSelections").setStyle("display","block");$("firstPollSelection").addClass("validate-minFields");}else{if(Q.target.id=="typeQuestion"){$$(".subjectHeading").set("text","Enter your question here");$$(".bodyHeading").set("text","Expand on your question by providing specific details here (this will help people answer your question):");}else{if(Q.target.id=="typeIdea"){$$(".subjectHeading").set("text","What is your idea?");$$(".bodyHeading").set("text","Provide some details of your idea here (required):");}}}});if($defined($("createThreadMini"))){$("createThreadForm").addEvent("click",function(Q){Q.stop();L(Q,$("createThreadMini"));});$("createThreadSubmit").addEvent("click",function(Q){Q.stop();L(Q,$("createThreadMini"));});G="Mini";}var P={};function A(){M=new ForumsFormValidator("createThreadForm",{errorPrefix:"",evaluateFieldsOnBlur:false,evaluateFieldsOnChange:false,evaluateOnSubmit:false,useTitles:true});}function D(){try{$$("#createThreadForm textarea").each(function(R){R.set("text","");});A();M.reset();$("createThreadForm").set("onsubmit","return false;");$("createThreadForm").addEvent("submit",function(){if(M.validate()){B($("createThreadMini"));}});$("createThreadSubmit").addEvent("click",function(R){R.stop();$("createThreadForm").fireEvent("submit");});if($("createThreadPreview")!=null){$("createThreadPreview").addEvent("click",function(R){R.stop();K(!$("createThreadPreview").hasClass("editButton"),M,$("createThreadForm"));});}$$("#createThreadMini .closeSticky").addEvent("click",function(R){R.stop();$("createThreadMini").removeClass("expanded");K(false);});if(I&&!O){if(P.createThread){P.createThread.attach();}else{if($("createThreadForm").getElement("textarea.body")){P.createThread=new MooEditable.CNET($("createThreadForm").getElement("textarea.body"),{injectIframe:"after"});}}}$$("#createThreadForm .textArea").each(function(R){R.set("value","");R.set("text","");});}catch(Q){dbug.log("createThread form error: %o",Q);}}function B(){new Request.JSON({url:$("createThreadForm").get("action"),data:$("createThreadForm").toQueryString()+"&viewType=json",onSuccess:function(T){T=T.response;var Q=T.status.$;var W=null;var S;for(var R in T.data){temp2=T.data;for(var V in temp2[R]){S=T.data[R];if(V=="@assetId"){W=S[V];}}}$$("#createThreadMini .result .username").set("text",UserVars.get("userName").replace("%20"," "));if(Q=="success"){C("createThread");E();if(W!=null){if(PageVars.get("nodeId")==11310||PageVars.get("siteId")==39){var U="/7723-11310_39-"+W+".html";$$(".viewThread").set("href","http://howto.cnet.com"+U);}else{var U="/7723-1_102-"+W+".html";$$(".viewThread").set("href","http://forums.cnet.com"+U);}$$(".bookmarkThread").removeEvents("click");$$(".bookmarkThread").addEvent("click",function(){var Y=$$("#createThreadMini .subject").get("value")+" - CNET Forums";if(PageVars.get("nodeId")==11310||PageVars.get("siteId")==39){var X="http://howto.cnet.com";}else{var X="http://forums.cnet.com";}if(window.sidebar){window.sidebar.addPanel(Y,X+U,"");}else{if(window.external){window.external.AddFavorite(X+U,Y);}}});if($$("#createThreadMini .trackThreadCheckbox")[0].get("checked")){$("createThreadMini").addClass("tracked");}$$(".trackThread").addEvent("click",function(){$$(".result .isTracked").set("html","&gt; Discussion is now tracked.");$$(".result .notTracked").hide();F(W);});J($$("#createThreadMini .subject")[0].get("value"),U,"{*actor*} posted this thread on CNET.",$$("#createThreadMini .body")[0].get("value"));}$("createThreadMini").addClass("submitted");}else{if(Q=="pending"){C("createThread");E();$("createThreadMini").addClass("pending");}else{if(Q=="duplicate"){C("submitFailed");E();$("createThreadMini").addClass("duplicate");}else{C("submitFailed");E();$("createThreadMini").addClass("failure");}}}},onFailure:function(Q){$("createThreadMini").addClass("failure");}}).send();}function E(){$("createThreadMini").removeClass("submitted");$("createThreadMini").removeClass("pending");$("createThreadMini").removeClass("duplicate");$("createThreadMini").removeClass("failure");$("createThreadMini").removeClass("tracked");$("createThreadMini").removeClass("preview");$("createThreadPreview").removeClass("editButton");}function N(R){if($(R.target).hasClass("submit")&&$(R.target).getParent("#createThreadMini").hasClass("expanded")){B(wrapper);}else{if(!R.target.getParent("#createThreadMini").hasClass("expanded")){D();K(false);if($("createThreadMini").hasClass("tracked")){$("createThreadMini").removeClass("tracked");$$(".result .isTracked").set("html","&gt; Manage your tracked discussions.");}if($defined($("createThreadMessageId"))){$("createThreadMessageId").set("value",R.target.getParent("div.post").get("messageId"));}var Q=$(R.target).get("forumId")||$(R.target).getParent().get("forumId");if(Q){$("createThreadForm").getElement("select.forumId").set("value",Q);}E();$("createThreadMini").addClass("expanded");$("createThreadForm").removeEvents("click");}}}function L(Q){CURS.Manager.checkLogin({registerHed:"Join CNET to create a new thread",loginHed:"Log in to CNET to create a new thread",appId:27,cval:"submitThread",nextAction:function(){N(Q);}});}function F(Q){new Request.JSON({url:"9876-"+PageVars.get("nodeId")+"_"+PageVars.get("siteId")+"-0.html?nomesh&action=track",data:"threadIds="+Q+"&track=true&viewType=json",onSuccess:function(S){S=S.response;var R=S.status.firstChild.nodeValue;if(R=="success"||R=="pending"){C("trackThread");E();$("createThreadMini").addClass("tracked");}else{dbug.log("Track thread failure.");}}}).send();}function K(R,T,U){var Q=$("createThreadPreview");if(Q!=null){var V=$$("#createThreadMini .previewFields");if(R&&!Q.hasClass("editButton")){if(T!=null&&T.validate()){var S=new Waiter(Q,{layer:{styles:{zIndex:1000010,background:"#FFF"},"class":"previewWaiter"}}).start();new Request({url:"/7730-"+PageVars.get("nodeId")+"_"+PageVars.get("siteId")+"-0.html?nomesh",data:U.toQueryString(),onSuccess:function(W,X){E();Q.set("html","Edit");Q.addClass("editButton");V.set("html",W);$("createThreadMini").addClass("preview");S.stop();},onFailure:function(W){$("createThreadMini").addClass("previewFailure");S.stop();}}).send();}}else{if(!R&&Q.hasClass("editButton")){E();Q.set("html","Preview");}}}}function C(Q){new Jlogger({tag:Q}).ping();}function J(W,T,R,U){if(CURS.Social.fb.isUser()){var Q=(T.contains("http://"+window.location.host))?T:"http://"+window.location.host+T;var S=[{text:"Read this post",href:Q}];if(!Cookie.read("cnet_noFbPublish")){try{CURS.Social.fb.ensureInit(function(){FB.Connect.streamPublish("",{name:W,href:Q,caption:R,description:CURS.Social.fb.getParsedText(U,4999,false)},S);},true);}catch(V){CURS.Social.fb.ensureActiveSession(function(){FB.ui({method:"stream.publish",display:"dialog",message:"",attachment:{name:W,href:Q,caption:R,description:CURS.Social.fb.getParsedText(U,4999,false)},action_links:S,user_message_prompt:""});});}}}}});var ConnectWithUs=new Class({Implements:Options,options:{nextAction:null,params:{count:"1",noUser:"true"}},initialize:function(B,A){this.elements=B;this.setOptions(A);$$(this.elements+" .connectWithUs .twitter").each(function(C){this.makeRequest(C);}.bind(this));this.nextAction();},makeRequest:function(A){if(A!=null&&A.get("twitterid")!=null){new Request.JSON({url:"/posidn/rest/v1.0/userTweets",data:$merge({"posidn.useSampleValues":"true",id:A.get("twitterid"),viewType:"json"},this.options.params),method:"get",onSuccess:function(B){dbug.log("ConnectWithUs - response received.");if(B!=null&&B.CNETResponse!=null){this.injectTweets(A,B.CNETResponse);}else{dbug.log("ConnectWithUs - invalid response.");}}.bind(this),onFailure:function(){dbug.log("ConnectWithUs - request failed.");}}).send();}else{dbug.log("ConnectWithUs - insufficient data.");}},injectTweets:function(C,A){if(A.statuses.status instanceof Array){var F=A.statuses.status;}else{var F=[A.statuses.status];}if(F[0]!=null){var E=new Element("span",{"class":"callout",html:'Latest from <a href="http://www.twitter.com/'+C.get("twitterid")+'">@'+C.get("twitterid")+"</a>:"}).inject(C);for(var B=0;B<F.length;B++){var D=new Element("span",{"class":"message",html:F[B].text.$}).inject(C);}}else{dbug.log("ConnectWithUs - no tweets.");}C.erase("twitterid");},nextAction:function(){try{if(this.options.nextAction!=null){this.options.nextAction();}}catch(A){dbug.log("ConnectWithUs - Next action failed");}}});window.addEvent("domready",function(){if(typeof (SocialBar)=="function"&&typeof (SocialBar.prototype)=="object"){new SocialBar($("contentMain"));}if($("mostPopularStoriesScroller")){try{dbug.log("Initializing mostPopularStoriesScroller's thumb scroller");new ThumbScroller("mpssWrapper",{axis:"x",thumbs:".story",nav:{next:$$("#mostPopularStoriesScroller .next"),previous:$$("#mostPopularStoriesScroller .previous")}}).addEvent("onComplete",function(){dbug.log("mostPopularStoriesScroller scroll event fired");$$(this.options.nav.previous).setStyle("opacity",((this.isAtStart())?".3":"1"));$$(this.options.nav.next).setStyle("opacity",((this.isAtEnd())?".3":"1"));}).fireEvent("onComplete");}catch(A){dbug.log("Most Popular Scroller failed");}}if(typeof (ConnectWithUs)=="function"&&typeof (ConnectWithUs.prototype)=="object"){new ConnectWithUs("#contentAux");}new QuickTabs("#contentAux .block3");$$(".block2 .quickTab .cta").each(function(){new Jlogger({tag:"noContentOnLoad-forums"}).ping();});});
   }
       